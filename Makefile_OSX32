all : libSerialComm.jnilib
	rm j_extensions_comm_SerialComm_SerialCommInputStream.h
	rm j_extensions_comm_SerialComm_SerialCommOutputStream.h
	rm OSX/SerialComm_OSX.o
	jar cmf MANIFEST.MF SerialComm.jar j/extensions/comm/*.class Linux OSX/x86/libSerialComm.jnilib OSX/x86_64/libSerialComm.jnilib Windows/x86/SerialComm.dll Windows/x86_64/SerialComm.dll
libSerialComm.jnilib : SerialComm_OSX.o
	cc -m32 -dynamiclib -o OSX/x86/libSerialComm.jnilib OSX/SerialComm_OSX.o -framework Cocoa -framework IOKit -framework JavaVM
SerialComm_OSX.o : OSX/SerialComm_OSX.cpp j_extensions_comm_SerialComm.h
	cc -m32 -I"/System/Library/Frameworks/JavaVM.framework/Versions/Current/Headers" -c OSX/SerialComm_OSX.cpp -o OSX/SerialComm_OSX.o
j_extensions_comm_SerialComm.h : j/extensions/comm/SerialComm.class
	javah -jni j.extensions.comm.SerialComm
clean :
	rm j_extensions_comm_SerialComm_SerialCommInputStream.h
	rm j_extensions_comm_SerialComm_SerialCommOutputStream.h
	rm j_extensions_comm_SerialComm.h
	rm OSX/SerialComm_OSX.o